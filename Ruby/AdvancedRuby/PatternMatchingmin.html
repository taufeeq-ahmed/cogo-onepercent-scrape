<html lang="en" class="h-full" style="overflow: hidden;"><head><meta charset="utf-8"><link rel="icon" href="/favicon"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#000000"><meta name="description" content="Web site created using create-react-app"><link rel="apple-touch-icon" href="/logo.png"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet"><link rel="manifest" href="/manifest.json"><style>*{font-family:Inter,"serif"}</style><title>Cogoport</title><script defer="defer" src="/static/js/main.21842ea9.js"></script><link href="/static/css/main.ff141865.css" rel="stylesheet"><link id="freshworks-frame" rel="stylesheet" href="https://ind-widget.freshworks.com/widgetBase/static/media/frame.d7ae132c.css"><style data-styled="active" data-styled-version="5.3.6"></style></head><body class="h-full"><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px; display: none;"></div><div class="hidden border-r md:fixed md:inset-y-0 md:flex md:w-64 md:flex-col" style="width: 19rem;"><div class="flex flex-col flex-grow pt-5 overflow-y-auto bg-white"><div class="flex items-center justify-between flex-shrink-0 px-4"><img class="w-auto h-8 " src="/static/media/cogoport_logo.d263efa364f64be3527aa336fdb65893.svg" alt="Your Company"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 cursor-pointer"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"></path></svg></div><div class="flex flex-col flex-1 mt-5 overflow-y-auto"><nav class="h-full px-2 pb-4"><h2 class="pb-2 mb-2 ml-3 font-bold border-b border-gray">Course Content</h2><div><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 bg-sky-100"><span class="
              mr-4 mt-1 text-primary"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              text-primary
            "><span>Pattern Matching<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(9, 103, 140);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 false"><span class="
              mr-4 mt-1"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              
            "><span>Blocks<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(52, 64, 84);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div></div></nav></div></div></div><div class="flex flex-col flex-1 md:pl-32"><div class="flex flex-col flex-1 md:pl-44"><div class="sticky top-0 z-10 flex flex-shrink-0 h-16 bg-white shadow md:hidden"><button type="button" class="px-4 text-gray-500 border-r border-gray-200 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-black md:hidden"><span class="sr-only">Open sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"></path></svg></button></div><main><div class="flex mb-3"><div class="relative w-8/12 border-r-2"><div id="scroller" class="h-screen overflow-y-scroll w-100 bg-gray-50"><div class="sc-bcXHqe sc-dkrFOg hiKaUt cDJYsG px-10 pt-5 pb-15"><h1>Pattern Matching</h1><h6>Ruby Course</h6><h2>Introduction</h2><div class="content"><p>Introduced in Ruby 2.7, pattern matching uses specified patterns to match against some data. If the data conforms to the pattern, there is a match and the data is deconstructed accordingly. If there is no match, you can either supply a default value to return or else a <code>NoMatchingPatternError</code> is raised.</p><p>With Ruby 3.1, most parts of the pattern matching syntax are no longer considered experimental, so it is now worth ensuring you are familiar with the basics. The syntax can feel a little clunky at first, but there are times it can definitely simplify Ruby code. There are a couple of new patterns with Ruby 3 which we'll introduce at the end.</p><p>If you want to play with the examples, make sure you're on at least Ruby 2.7 or use replit.com.</p></div><h2>Learning Outcomes</h2><div class="content"><p>By the end of this lesson, you should be able to do the following:</p><ul>
    <li>Explain the syntax for implementing a pattern matching case statement.</li>
    <li>Explain what types can be used in pattern matching.</li>
    <li>Explain the possible return values from a pattern match</li>
    <li>Explain how to implement a guard condition in a pattern match statement.</li>
    <li>Explain how to pattern match against an Array and Arrays within Arrays.</li>
    <li>Explain how to pattern match against a Hash.</li>
    <li>Explain the main differences between Hash and Array pattern matching.</li>
    <li>Explain the use of the pin operator.</li>
    <li>Explain the use of the alternative pattern.</li>
    <li>Explain how to bind matches to a variable.</li>
    <li>Explain how to match against your own custom classes.</li>
  </ul></div><h2>Basics</h2><div class="content"><p>The basic format for a pattern match is a case statement. This is not too different from the case statement you are already familiar with for matching conditions in Ruby, except now instead of <code>when</code>, we use <code>in</code>. If your use case is very basic, you will find there is no difference between using either <code>in</code> or <code>when</code> as the below example illustrates.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">grade <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'C'</span></span>

<span class="token keyword">case</span> grade
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'A'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Amazing effort'</span></span>
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'B'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Good work'</span></span>
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'C'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Well done'</span></span>
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'D'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Room for improvement'</span></span>
<span class="token keyword">else</span> puts <span class="token string-literal"><span class="token string">'See me'</span></span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; Well done</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>vs pattern matching syntax</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">grade <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'C'</span></span>

<span class="token keyword">case</span> grade
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'A'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Amazing effort'</span></span>
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'B'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Good work'</span></span>
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'C'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Well done'</span></span>
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'D'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Room for improvement'</span></span>
<span class="token keyword">else</span> puts <span class="token string-literal"><span class="token string">'See me'</span></span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; Well done</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The second format is a one line syntax using the trusty hash rocket that will be familiar to you from hashes.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">login <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'hornby'</span></span><span class="token punctuation">,</span> <span class="token symbol">password</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'iliketrains'</span></span> <span class="token punctuation">}</span>

login <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> username <span class="token punctuation">}</span>

puts <span class="token string-literal"><span class="token string">"Logged in with username </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">username</span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span>

<span class="token comment">#=&gt; Logged in with username hornby</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>We'll get to matching against hashes shortly so don't worry about the exact syntax of what is happening. Just note that we can use the hash rocket <code>=&gt;</code> to match against some kind of structure. The second format is still considered experimental so the examples that follow will use the case statement format.</p><p>The case/in format is best used when there are multiple conditionals you could possibly match against and you need to check against all of them. The hash rocket syntax is best used when the data structure you are matching against is known, such as the login data example we used above.</p></div><h2>Patterns</h2><div class="content"><p>There are multiple ways of potentially matching against an input. Patterns can be:</p><ul>
    <li>Any Ruby object which is matched using <code>===</code>. The Object Pattern.</li>
    <li>A variable capture / Variable Pattern</li>
    <li>An As Pattern</li>
    <li>An Alternative Pattern</li>
    <li>A Guard Condition</li>
    <li>An Array Pattern</li>
    <li>A Hash Pattern</li>
  </ul><p>You can use the above patterns while also having the following experimental additions.</p><ul>
    <li>Rightward Assignment</li>
    <li>A Find Pattern</li>
  </ul><p>Patterns can also be matched using many of the patterns above together. For example, you may have an array inside a hash, so you could use the hash and array patterns. We'll go through each of the various patterns in more detail below.</p><p>When we say 'pattern', we aren't talking about design patterns which you may have come across. We mean the pattern used to match against an input.</p></div><h2>Return Values</h2><div class="content"><p>There are two possible return values from a pattern match statement. The first is <code>true</code>, which is returned whenever there is a match, even when the match is the else clause in a statement. The second possible return value is a <code>NoMatchingPatternError</code> whenever no match can be found. In our examples below, when we <code>puts</code> something inside a case statement, we'll use <code># =&gt;</code> to show the value that will be printed by this. In your terminal, though, you'll see the value printed followed by <code>=&gt; true</code> below. We'll omit that because it's not relevant to what we're trying to show you. Just be aware that the <code>true</code> you see is just the return value of the last thing evaluated. Standard Ruby behaviour.</p><p>As you'll see, though, the point of a pattern match usually is to not only match against a pattern, but also bind all or part of the match to one or more variables that you can then use outside of the pattern match expression.</p></div><h2>Object Pattern Match</h2><div class="content"><p>Any object can be used in a pattern match. It is matched using <code>===</code> to compare the two objects and is the same basis for matches in the case/when format. This pattern is usually used within other patterns, such as the array pattern.</p><p>The grade example provided earlier was one such use of the Ruby object pattern match. On each check, Ruby compared the grade with the specified letter. When there was a match, it executed the then clause of that match. <code>'A' === 'A' #=&gt; true</code>.</p><p>Because of this we can also check against data types.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">input <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">case</span> input
<span class="token keyword">in</span> <span class="token builtin">String</span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'input was of type String'</span></span>
<span class="token keyword">in</span> <span class="token builtin">Integer</span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'input was of type Integer'</span></span>
<span class="token keyword">end</span>

<span class="token comment">#=&gt; input was of type Integer</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>It's important to note here that Ruby places the pattern to match on the left of the comparison in <code>===</code>. If it didn't then there would be no match. <code>3 === Integer</code> is false whereas <code>Integer === 3</code> is true. That is because of how Ruby implements the <code>===</code> method on Integer vs on instances of Integer. On Integer, <code>===</code> will check that the operand on the right of the comparison is of type Integer. On an instance of an integer, <code>===</code> will check they hold the same value. <code>3 === 3</code> is true.</p><p>With Ruby pattern matching, you can match against the following literal types.</p><ul>
    <li>Booleans</li>
    <li>nil</li>
    <li>Numbers</li>
    <li>Strings</li>
    <li>Symbols</li>
    <li>Arrays</li>
    <li>Hashes</li>
    <li>Ranges</li>
    <li>Regular Expressions</li>
    <li>Procs</li>
  </ul><p>This isn't any different from what we can do with a case/when statement, but the power comes when you match these types within some of the other patterns as we'll see next.</p></div><h2>Variable Pattern</h2><div class="content"><p>The variable pattern binds a variable or variables to the values that match the pattern.</p><p>The basic format is:</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">age <span class="token operator">=</span> <span class="token number">15</span>

<span class="token keyword">case</span> age
<span class="token keyword">in</span> a
  puts a
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 15</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>This example isn't useful in itself, but lays the foundation for use in other patterns as we'll see.</p><p>Something to take note of is that the variable pattern always binds the value to the variable. Be careful if there is another variable with the same name in the outer scope which you'll need.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">a <span class="token operator">=</span> <span class="token number">5</span>

<span class="token keyword">case</span> <span class="token number">1</span>
<span class="token keyword">in</span> a
  a
<span class="token keyword">end</span>

puts a
<span class="token comment">#=&gt; 1</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Above, you might have thought you were comparing the value held in the initial <code>a</code> variable against the value <code>1</code> from the case statement. What actually happened is a variable assignment pattern match. To avoid this, Ruby provides the pin operator <code>^</code> which instead matches against a variable of that name.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">a <span class="token operator">=</span> <span class="token number">5</span>

<span class="token keyword">case</span> <span class="token number">1</span>
<span class="token keyword">in</span> <span class="token operator">^</span>a
  <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment">#=&gt; NoMatchingPatternError</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2>As Pattern Match</h2><div class="content"><p>The as pattern is similar to the variable pattern but can be used to manage more complex assignments. This will make most sense when using Arrays and Hashes so examples will be shown when covering those patterns but the general pattern is written as follows:</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token number">3</span>
<span class="token keyword">in</span> <span class="token number">3</span> <span class="token operator">=&gt;</span> a
  puts a
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 3</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>It uses the hash rocket in the same way the one line pattern match does. Look out for the examples in later sections for clarification on when this pattern could be useful.</p></div><h2>Alternative Pattern Match</h2><div class="content"><p>The alternative pattern allows you to check if multiple options match the input.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token number">0</span>
<span class="token keyword">in</span> <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">2</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>There isn't much more to it. The same rules apply as with any other pattern. So you can use the <code>^</code> operator if you are using variables to compare.</p></div><h2>Guard Conditions</h2><div class="content"><p>This isn't a pattern per se, but a way to make sure the pattern is only matched if the guard condition holds true.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">some_other_value <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token keyword">case</span> <span class="token number">0</span>
<span class="token keyword">in</span> <span class="token number">0</span> <span class="token keyword">if</span> some_other_value
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can use any expression in the condition that can evaluate to true or false. You can also use <code>unless</code> instead of <code>if</code> if it suits you.</p></div><h2>Array Pattern Match</h2><div class="content"><p>Matching against arrays can be done in a few different ways. At its most basic, you can match against the exact elements in the array.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">then</span> puts <span class="token symbol">:match</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token keyword">then</span> puts <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>That works using the <code>===</code> operator from the object pattern match so would work using case/when. That's no fun, so let's ramp it up a little bit.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Here we've matched against the type of the arrays elements. This is an example of Ruby matching against a pattern rather than the actual values in the array.</p><p>What happens if we have more elements in the array?</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [1, 2, 3] (NoMatchingPatternError)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>An error! Ruby appears to only match against arrays with the same number of elements. What if you want to match against only part of an array? Use the trusty splat <code>*</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can place the splat anywhere in an array to match against multiple entries.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Here we are checking only the first and last two elements are Integers. You can also mix and match between checking actual values and types.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>If you want to scoop up the values of the array matched against the splat, you can use the variable pattern.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">*</span>tail<span class="token punctuation">]</span>
  p tail
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [3, 4]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>If you don't care about some values in the array and are happy to match against any value for that index you can use <code>_</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Let's say you want to match against an array of two numbers, but only if they aren't the same number. You can use a guard clause.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token keyword">unless</span> a <span class="token operator">==</span> b
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can even match against nested arrays.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>This is where the real power of pattern matching shines: traversing deeply nested structures for matches.</p><p>You can incorporate the variable pattern to bind matching values to variables to use later.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">]</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 4</span>
<span class="token comment"># =&gt; 5</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Let's say you have a nested array and you want to match against both the nested array and some individual parts of it. This is where the as pattern can be used.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> a<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">]</span>
  puts a
  p arr
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 5</span>
<span class="token comment"># =&gt; [4, 5]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Be careful with variable reassignment as we discussed earlier.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> arr
  <span class="token symbol">:match</span>
<span class="token keyword">end</span>

p arr

<span class="token comment"># =&gt; [1, 2, 4]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>One last point to note is that when matching an array the <code>[]</code> are optional on the outer array.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2>Hash Pattern Matching</h2><div class="content"><p>Pattern Matching with Hashes works in a similar way to arrays with a couple of important differences. The first is that pattern matching only works for symbol keys, not string keys. The reason for this is to do with how Ruby matches against a hash. This may change in future Ruby versions. The second important difference is that unlike with arrays, you can match against parts of a Hash without having to handle the fact there may be additional key-value pairs.</p><p>We can match against the actual values of a hash.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'aardvark'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'bat'</span></span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>We can match against a hash and assign values to variables.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> a<span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> b <span class="token punctuation">}</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; apple</span>
<span class="token comment"># =&gt; banana</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Because of Ruby syntactic sugar for hashes, we could rewrite the above as below. Note how we don't have to provide names for the variables. This isn't pattern matching behaviour but normal Ruby hash behaviour.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token punctuation">}</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; apple</span>
<span class="token comment"># =&gt; banana</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>As with arrays, with hashes you can omit the brackets <code>{}</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> a<span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; apple</span>
<span class="token comment"># =&gt; banana</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can use the double splat <code>**</code> to scoop up multiple key-value pairs.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span><span class="token punctuation">,</span> <span class="token symbol">c</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'cat'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token operator">**</span>rest <span class="token punctuation">}</span>
  p rest
<span class="token keyword">end</span>

<span class="token comment"># =&gt; { :b =&gt; "ball", :c =&gt; "cat" }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Something to be mindful of with hashes is that because a hash will match with only a subset of keys matching, you need to guard against situations where you don't want that behaviour.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span> <span class="token punctuation">}</span>
  <span class="token string-literal"><span class="token string">'this will match'</span></span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
  <span class="token string-literal"><span class="token string">'this will never be reached'</span></span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>If you want to ensure you only match exactly you can use <code>**nil</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token keyword">nil</span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>We can use the as pattern to assign the entire hash match to a variable.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span> <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> hash
  p hash
<span class="token keyword">end</span>

<span class="token comment">#=&gt; { :a =&gt; 'ant', :b =&gt; 'ball' }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2>Ruby 3 Patterns</h2><div class="content"><p>With Ruby 3 came a couple of new patterns. You may get a warning about these features being experimental and subject to change so they aren't yet considered ready for any production code.</p></div><h2>Rightward Assignment</h2><div class="content"><p>Usually, you place variables on the left of an expression that binds a value to that variable. With rightward assignment you deconstruct an object and assign values to variables on the right of the expression. Instead of using <code>=</code> to assign you use a hash rocket <code>=&gt;</code>.</p><p>All of the previous patterns we've covered can be used in this syntax.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">login <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'hornby'</span></span><span class="token punctuation">,</span> <span class="token symbol">password</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'iliketrains'</span></span> <span class="token punctuation">}</span>

login <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> username <span class="token punctuation">}</span>

puts <span class="token string-literal"><span class="token string">"Logged in with username </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">username</span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span>

<span class="token comment">#=&gt; "Logged in with username hornby"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The case/in format is best used when there are multiple conditionals you could possibly match against and you need to check against all of them. The hash rocket syntax is best used when the data structure you are matching against is known, such as the login data example we used above.</p></div><h2>Find Pattern</h2><div class="content"><p>As we saw earlier, we can match against part of a hash using the array pattern match. So what do you do if you need to match against part of an array? The as pattern would capture all of the array and the variable pattern captures individual parts of it. To address this, Ruby added the find pattern.</p><p>It works by placing a <code>*</code> either side of the part you want to match. You can even use the variable pattern to give each <code>*</code> a variable name to reference later. Let's look at some examples.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span>pre<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">*</span>post<span class="token punctuation">]</span>
  p pre
  p post
<span class="token keyword">end</span>

<span class="token comment"># =&gt; []</span>
<span class="token comment"># =&gt; []</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Because everything was matched between the pattern our <code>pre</code> and <code>post</code> variables were assigned empty arrays. Let's see what happens when they aren't.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span>pre<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">*</span>post<span class="token punctuation">]</span>
  p pre
  p post
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [1]</span>
<span class="token comment"># =&gt; [4, 5]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Here's an interesting one. Let's say you have a mixed array of strings and integers and want to match on the first instance of two consecutive strings. While that would be a bit of a pain to implement without using pattern matching, with the find pattern it's easy. We can even throw in the as pattern to grab the values of the two consecutive strings.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"a"</span></span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"b"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"c"</span></span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span>pre<span class="token punctuation">,</span> <span class="token builtin">String</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">,</span> <span class="token builtin">String</span> <span class="token operator">=&gt;</span> z<span class="token punctuation">,</span> <span class="token operator">*</span>post<span class="token punctuation">]</span>
  p pre
  p x
  p z
  p post
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [1, 2, "a", 4]</span>
<span class="token comment"># =&gt; "b"</span>
<span class="token comment"># =&gt; "c"</span>
<span class="token comment"># =&gt; [7, 8, 9]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>As a last example, we'll consider a common use case which will hopefully show where the find pattern could be a better fit than a conventional Ruby solution. It's not uncommon in Ruby to find yourself with an array of hashes or JSON data, and you might need to locate a record from that data. You need to match that data on a few hash keys. The data might look something like this.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">data <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'James'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'english'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'general manager'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Jill'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'italian'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'leet coder'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Helen'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'dutch'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'biscuit quality control'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Bob'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'english'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'table tennis king'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Betty'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'spanish'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'pie maker'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Let's say you get a name, age, and job title as parameters. If that person exists, you need to return their first language, otherwise <code>nil</code>. Before pattern matching, you may do something like this.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'Jill'</span></span>
age <span class="token operator">=</span> <span class="token number">32</span>
job_title <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'leet coder'</span></span>

match <span class="token operator">=</span> data<span class="token punctuation">.</span>find <span class="token keyword">do</span> <span class="token operator">|</span>person<span class="token operator">|</span>
  person<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span> <span class="token operator">==</span> name <span class="token operator">&amp;&amp;</span> person<span class="token punctuation">[</span><span class="token symbol">:age</span><span class="token punctuation">]</span> <span class="token operator">==</span> age <span class="token operator">&amp;&amp;</span> person<span class="token punctuation">[</span><span class="token symbol">:job_title</span><span class="token punctuation">]</span> <span class="token operator">==</span> job_title
<span class="token keyword">end</span>

match<span class="token operator">&amp;.</span>fetch<span class="token punctuation">(</span><span class="token symbol">:first_language</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>A couple of things to note here. Firstly, because <code>match</code> could be <code>nil</code> if it couldn't find a record, we had to use the <code>&amp;</code> safe search navigator to check that we could call fetch on match. Otherwise, it would have blown up with a no method error. Secondly, while this isn't actually that bad, imagine we had more than 3 fields to search. What if there were 10? Our code would start to get out of control.</p><p>Now let's see how we could have handled it using a pattern match.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'Jill'</span></span>
age <span class="token operator">=</span> <span class="token number">32</span>
job_title <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'leet coder'</span></span>

<span class="token keyword">case</span> data
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token operator">^</span>name<span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token operator">^</span>age<span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> first_language<span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token operator">^</span>job_title <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">]</span>
<span class="token keyword">else</span>
  first_language <span class="token operator">=</span> <span class="token keyword">nil</span>
<span class="token keyword">end</span>

puts first_language

<span class="token comment"># =&gt; italian</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>With pattern matching, we do need to consider the case if there is no match. Without the else clause, we'd get the no matching pattern error. But that is exactly what the else clause is for in the case statement. We get a couple of benefits from doing it this way. Firstly, we can bind the <code>first_language</code> value to a variable right there in the pattern. Secondly, and we acknowledge this is somewhat subjective, but we find it beneficial in the case statement to see exactly what kind of data structure we're trying to match against. This can be useful when getting to grips with code where the data may come from a third party API. And remember, this is still a very simplistic example. In the real world, data can be nested several levels deep which can lead to a horrible tangle of spaghetti code when trying to make sure you can locate a value several levels deep. What if you had to dive 6 levels, but grab a value or two along the way from a couple of the higher levels? No problem with pattern matching.</p></div><h2>Wrapping Up</h2><div class="content"><p>Pattern Matching provides a powerful way to get at the data you need in a way that makes sense. But as with any tool, you don't need to reach for it in every use case. For data structures that are shallow, just think about whether you need to bring in a pattern match when you could just grab the value using the hash and array methods already available. If you do find yourself deep in a nested structure with many checks for <code>nil</code> and a lot of edge case handling, it might be time to see if pattern matching brings something to the table.</p></div><h2>Assignment</h2><div class="content"><div class="lesson-content__panel">

    <ol>
      <li>Start with the <a href="https://docs.ruby-lang.org/en/3.0/syntax/pattern_matching_rdoc.html" target="_blank" rel="noopener noreferrer">Ruby docs</a> on pattern matching. They cover quite a lot of ground.</li>
      <li>One thing we didn't cover here is matching your own objects. We did mention implementing the <code>===</code> method, but there are a couple of other methods you can implement that will allow you to use array and hash pattern matching. Check out this <a href="https://rubyreferences.github.io/rubyref/language/pattern-matching.html" target="_blank" rel="noopener noreferrer">guide to pattern matching</a>, particularly this section on <a href="https://rubyreferences.github.io/rubyref/language/pattern-matching.html#matching-non-primitive-objects-deconstruct_keys-and-deconstruct" target="_blank" rel="noopener noreferrer">matching objects</a>.</li>
    </ol>
  </div></div><h2>Additional Resources</h2><div class="content"><p>This section contains helpful links to other content. It isn't required, so consider it supplemental.</p><ul>
    <li><a href="https://blog.appsignal.com/2021/07/28/introduction-to-pattern-matching-in-ruby.html" target="_blank" rel="noopener noreferrer">An Introduction to Pattern Matching in Ruby</a> from AppSignal should be another useful perspective on the material.</li>
    <li><a href="https://rubyreferences.github.io/rubyref/language/pattern-matching.html" target="_blank" rel="noopener noreferrer">Pattern matching</a> from Ruby References (Github) covers some more practical uses</li>
  </ul></div><h2>Knowledge Check</h2><div class="content"><p>This section contains questions for you to check your understanding of this lesson. If you're having trouble answering the questions below on your own, review the material above to find the answer.</p><ul>
    <li><a class="knowledge-check-link" href="https://docs.ruby-lang.org/en/3.0/syntax/pattern_matching_rdoc.html">What is pattern matching?</a></li>
    <li><a class="knowledge-check-link" href="https://docs.ruby-lang.org/en/3.0/syntax/pattern_matching_rdoc.html#label-Patterns">What is the difference between array patterns and hash patterns?</a></li>
    <li><a class="knowledge-check-link" href="#variable-pattern">What is the variable pattern match?</a></li>
    <li><a class="knowledge-check-link" href="#array-pattern-match">What are the different ways of pattern matching on an array?</a></li>
    <li><a class="knowledge-check-link" href="#find-pattern">Explain the find pattern.</a></li>
  </ul></div></div></div><div class="sticky bottom-0 left-0 right-0 flex justify-end px-4 pt-4 pb-5 bg-white border-t border-gray"><button class="inline-flex justify-center rounded-md border border-transparent text-base font-medium  shadow-sm hover:bg-indigo-700 focus:outline-none sm:text-sm inline-flex w-full justify-center rounded-md border border-transparent bg-gray-300 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:text-sm h-9 text-13px px-20px w-auto" type="button" aria-label="button" disabled="">Mark as complete</button></div></div><div class="flex-col w-4/12"><div class="pb-2 mb-2 border-b border-gray"><div class="pt-4 pb-2 pl-2 ml-2 text-lg font-medium">Additional Links</div></div><div class="pl-3 mt-2 overflow-y-scroll text-sm" style="height: 100vh;"><nav class="sticky flex"><div class="w-full px-2 "></div></nav></div></div></div></main></div><div></div></div></div><script>window.fwSettings={widget_id:89000000687},function(){if("function"!=typeof window.FreshworksWidget){var i=function(){i.q.push(arguments)};i.q=[],window.FreshworksWidget=i}}()</script><script type="text/javascript" src="https://ind-widget.freshworks.com/widgets/89000000687.js" async="" defer="defer"></script><div id="freshworks-container" data-html2canvas-ignore="true" style="width: 0px; height: 0px; bottom: 0px; right: 0px; z-index: 2147483647;"><div aria-live="polite"><iframe allowfullscreen="" id="launcher-frame" data-testid="launcher-frame" style="right: 22px; bottom: 22px; border: none; position: fixed; min-width: 104px; max-width: 156px; height: 56px; z-index: 2147483000; visibility: visible;"></iframe></div></div><iframe title="FreshworksWidget" id="freshworks-frame" data-html2canvas-ignore="true" style="display: none;"></iframe><div id="headlessui-portal-root"><div data-headlessui-portal=""><button type="button" data-headlessui-focus-guard="true" aria-hidden="true" style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px;"></button><div><div class="relative z-40 md:hidden" id="headlessui-dialog-:r6:" role="dialog" aria-modal="true" data-headlessui-state="open"><div class="fixed inset-0 bg-gray-600 bg-opacity-75"></div><div class="fixed inset-0 z-40 flex"><div class="relative flex flex-col flex-1 w-full max-w-xs pt-5 pb-4 bg-white" id="headlessui-dialog-panel-:r7:" data-headlessui-state="open"><div class="absolute top-0 right-0 pt-2 -mr-12"><button type="button" class="flex items-center justify-center w-10 h-10 ml-1 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white"><span class="sr-only">Close sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-6 h-6 text-white"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="flex items-center justify-between flex-shrink-0 px-4"><img class="w-auto h-8" src="/static/media/cogoport_logo.d263efa364f64be3527aa336fdb65893.svg" alt="Your Company"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 cursor-pointer"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"></path></svg></div><div class="flex-1 h-0 mt-5 overflow-y-auto"><h2>Course Content</h2><nav class="px-2 space-y-1"><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 bg-sky-100"><span class="
              mr-4 mt-1 text-primary"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              text-primary
            "><span>Pattern Matching<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(9, 103, 140);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 false"><span class="
              mr-4 mt-1"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              
            "><span>Blocks<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(52, 64, 84);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div></nav></div></div><div class="flex-shrink-0 w-14" aria-hidden="true"></div></div></div></div><button type="button" data-headlessui-focus-guard="true" aria-hidden="true" style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px;"></button></div></div></body></html><html lang="en" class="h-full" style="overflow: hidden;"><head><meta charset="utf-8"><link rel="icon" href="/favicon"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#000000"><meta name="description" content="Web site created using create-react-app"><link rel="apple-touch-icon" href="/logo.png"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet"><link rel="manifest" href="/manifest.json"><style>*{font-family:Inter,"serif"}</style><title>Cogoport</title><script defer="defer" src="/static/js/main.21842ea9.js"></script><link href="/static/css/main.ff141865.css" rel="stylesheet"><link id="freshworks-frame" rel="stylesheet" href="https://ind-widget.freshworks.com/widgetBase/static/media/frame.d7ae132c.css"><style data-styled="active" data-styled-version="5.3.6"></style></head><body class="h-full"><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px; display: none;"></div><div class="hidden border-r md:fixed md:inset-y-0 md:flex md:w-64 md:flex-col" style="width: 19rem;"><div class="flex flex-col flex-grow pt-5 overflow-y-auto bg-white"><div class="flex items-center justify-between flex-shrink-0 px-4"><img class="w-auto h-8 " src="/static/media/cogoport_logo.d263efa364f64be3527aa336fdb65893.svg" alt="Your Company"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 cursor-pointer"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"></path></svg></div><div class="flex flex-col flex-1 mt-5 overflow-y-auto"><nav class="h-full px-2 pb-4"><h2 class="pb-2 mb-2 ml-3 font-bold border-b border-gray">Course Content</h2><div><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 bg-sky-100"><span class="
              mr-4 mt-1 text-primary"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              text-primary
            "><span>Pattern Matching<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(9, 103, 140);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 false"><span class="
              mr-4 mt-1"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              
            "><span>Blocks<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(52, 64, 84);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div></div></nav></div></div></div><div class="flex flex-col flex-1 md:pl-32"><div class="flex flex-col flex-1 md:pl-44"><div class="sticky top-0 z-10 flex flex-shrink-0 h-16 bg-white shadow md:hidden"><button type="button" class="px-4 text-gray-500 border-r border-gray-200 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-black md:hidden"><span class="sr-only">Open sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"></path></svg></button></div><main><div class="flex mb-3"><div class="relative w-8/12 border-r-2"><div id="scroller" class="h-screen overflow-y-scroll w-100 bg-gray-50"><div class="sc-bcXHqe sc-dkrFOg hiKaUt cDJYsG px-10 pt-5 pb-15"><h1>Pattern Matching</h1><h6>Ruby Course</h6><h2>Introduction</h2><div class="content"><p>Introduced in Ruby 2.7, pattern matching uses specified patterns to match against some data. If the data conforms to the pattern, there is a match and the data is deconstructed accordingly. If there is no match, you can either supply a default value to return or else a <code>NoMatchingPatternError</code> is raised.</p><p>With Ruby 3.1, most parts of the pattern matching syntax are no longer considered experimental, so it is now worth ensuring you are familiar with the basics. The syntax can feel a little clunky at first, but there are times it can definitely simplify Ruby code. There are a couple of new patterns with Ruby 3 which we'll introduce at the end.</p><p>If you want to play with the examples, make sure you're on at least Ruby 2.7 or use replit.com.</p></div><h2>Learning Outcomes</h2><div class="content"><p>By the end of this lesson, you should be able to do the following:</p><ul>
    <li>Explain the syntax for implementing a pattern matching case statement.</li>
    <li>Explain what types can be used in pattern matching.</li>
    <li>Explain the possible return values from a pattern match</li>
    <li>Explain how to implement a guard condition in a pattern match statement.</li>
    <li>Explain how to pattern match against an Array and Arrays within Arrays.</li>
    <li>Explain how to pattern match against a Hash.</li>
    <li>Explain the main differences between Hash and Array pattern matching.</li>
    <li>Explain the use of the pin operator.</li>
    <li>Explain the use of the alternative pattern.</li>
    <li>Explain how to bind matches to a variable.</li>
    <li>Explain how to match against your own custom classes.</li>
  </ul></div><h2>Basics</h2><div class="content"><p>The basic format for a pattern match is a case statement. This is not too different from the case statement you are already familiar with for matching conditions in Ruby, except now instead of <code>when</code>, we use <code>in</code>. If your use case is very basic, you will find there is no difference between using either <code>in</code> or <code>when</code> as the below example illustrates.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">grade <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'C'</span></span>

<span class="token keyword">case</span> grade
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'A'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Amazing effort'</span></span>
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'B'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Good work'</span></span>
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'C'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Well done'</span></span>
<span class="token keyword">when</span> <span class="token string-literal"><span class="token string">'D'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Room for improvement'</span></span>
<span class="token keyword">else</span> puts <span class="token string-literal"><span class="token string">'See me'</span></span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; Well done</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>vs pattern matching syntax</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">grade <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'C'</span></span>

<span class="token keyword">case</span> grade
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'A'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Amazing effort'</span></span>
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'B'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Good work'</span></span>
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'C'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Well done'</span></span>
<span class="token keyword">in</span> <span class="token string-literal"><span class="token string">'D'</span></span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'Room for improvement'</span></span>
<span class="token keyword">else</span> puts <span class="token string-literal"><span class="token string">'See me'</span></span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; Well done</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The second format is a one line syntax using the trusty hash rocket that will be familiar to you from hashes.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">login <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'hornby'</span></span><span class="token punctuation">,</span> <span class="token symbol">password</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'iliketrains'</span></span> <span class="token punctuation">}</span>

login <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> username <span class="token punctuation">}</span>

puts <span class="token string-literal"><span class="token string">"Logged in with username </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">username</span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span>

<span class="token comment">#=&gt; Logged in with username hornby</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>We'll get to matching against hashes shortly so don't worry about the exact syntax of what is happening. Just note that we can use the hash rocket <code>=&gt;</code> to match against some kind of structure. The second format is still considered experimental so the examples that follow will use the case statement format.</p><p>The case/in format is best used when there are multiple conditionals you could possibly match against and you need to check against all of them. The hash rocket syntax is best used when the data structure you are matching against is known, such as the login data example we used above.</p></div><h2>Patterns</h2><div class="content"><p>There are multiple ways of potentially matching against an input. Patterns can be:</p><ul>
    <li>Any Ruby object which is matched using <code>===</code>. The Object Pattern.</li>
    <li>A variable capture / Variable Pattern</li>
    <li>An As Pattern</li>
    <li>An Alternative Pattern</li>
    <li>A Guard Condition</li>
    <li>An Array Pattern</li>
    <li>A Hash Pattern</li>
  </ul><p>You can use the above patterns while also having the following experimental additions.</p><ul>
    <li>Rightward Assignment</li>
    <li>A Find Pattern</li>
  </ul><p>Patterns can also be matched using many of the patterns above together. For example, you may have an array inside a hash, so you could use the hash and array patterns. We'll go through each of the various patterns in more detail below.</p><p>When we say 'pattern', we aren't talking about design patterns which you may have come across. We mean the pattern used to match against an input.</p></div><h2>Return Values</h2><div class="content"><p>There are two possible return values from a pattern match statement. The first is <code>true</code>, which is returned whenever there is a match, even when the match is the else clause in a statement. The second possible return value is a <code>NoMatchingPatternError</code> whenever no match can be found. In our examples below, when we <code>puts</code> something inside a case statement, we'll use <code># =&gt;</code> to show the value that will be printed by this. In your terminal, though, you'll see the value printed followed by <code>=&gt; true</code> below. We'll omit that because it's not relevant to what we're trying to show you. Just be aware that the <code>true</code> you see is just the return value of the last thing evaluated. Standard Ruby behaviour.</p><p>As you'll see, though, the point of a pattern match usually is to not only match against a pattern, but also bind all or part of the match to one or more variables that you can then use outside of the pattern match expression.</p></div><h2>Object Pattern Match</h2><div class="content"><p>Any object can be used in a pattern match. It is matched using <code>===</code> to compare the two objects and is the same basis for matches in the case/when format. This pattern is usually used within other patterns, such as the array pattern.</p><p>The grade example provided earlier was one such use of the Ruby object pattern match. On each check, Ruby compared the grade with the specified letter. When there was a match, it executed the then clause of that match. <code>'A' === 'A' #=&gt; true</code>.</p><p>Because of this we can also check against data types.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">input <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">case</span> input
<span class="token keyword">in</span> <span class="token builtin">String</span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'input was of type String'</span></span>
<span class="token keyword">in</span> <span class="token builtin">Integer</span> <span class="token keyword">then</span> puts <span class="token string-literal"><span class="token string">'input was of type Integer'</span></span>
<span class="token keyword">end</span>

<span class="token comment">#=&gt; input was of type Integer</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>It's important to note here that Ruby places the pattern to match on the left of the comparison in <code>===</code>. If it didn't then there would be no match. <code>3 === Integer</code> is false whereas <code>Integer === 3</code> is true. That is because of how Ruby implements the <code>===</code> method on Integer vs on instances of Integer. On Integer, <code>===</code> will check that the operand on the right of the comparison is of type Integer. On an instance of an integer, <code>===</code> will check they hold the same value. <code>3 === 3</code> is true.</p><p>With Ruby pattern matching, you can match against the following literal types.</p><ul>
    <li>Booleans</li>
    <li>nil</li>
    <li>Numbers</li>
    <li>Strings</li>
    <li>Symbols</li>
    <li>Arrays</li>
    <li>Hashes</li>
    <li>Ranges</li>
    <li>Regular Expressions</li>
    <li>Procs</li>
  </ul><p>This isn't any different from what we can do with a case/when statement, but the power comes when you match these types within some of the other patterns as we'll see next.</p></div><h2>Variable Pattern</h2><div class="content"><p>The variable pattern binds a variable or variables to the values that match the pattern.</p><p>The basic format is:</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">age <span class="token operator">=</span> <span class="token number">15</span>

<span class="token keyword">case</span> age
<span class="token keyword">in</span> a
  puts a
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 15</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>This example isn't useful in itself, but lays the foundation for use in other patterns as we'll see.</p><p>Something to take note of is that the variable pattern always binds the value to the variable. Be careful if there is another variable with the same name in the outer scope which you'll need.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">a <span class="token operator">=</span> <span class="token number">5</span>

<span class="token keyword">case</span> <span class="token number">1</span>
<span class="token keyword">in</span> a
  a
<span class="token keyword">end</span>

puts a
<span class="token comment">#=&gt; 1</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Above, you might have thought you were comparing the value held in the initial <code>a</code> variable against the value <code>1</code> from the case statement. What actually happened is a variable assignment pattern match. To avoid this, Ruby provides the pin operator <code>^</code> which instead matches against a variable of that name.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">a <span class="token operator">=</span> <span class="token number">5</span>

<span class="token keyword">case</span> <span class="token number">1</span>
<span class="token keyword">in</span> <span class="token operator">^</span>a
  <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment">#=&gt; NoMatchingPatternError</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2>As Pattern Match</h2><div class="content"><p>The as pattern is similar to the variable pattern but can be used to manage more complex assignments. This will make most sense when using Arrays and Hashes so examples will be shown when covering those patterns but the general pattern is written as follows:</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token number">3</span>
<span class="token keyword">in</span> <span class="token number">3</span> <span class="token operator">=&gt;</span> a
  puts a
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 3</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>It uses the hash rocket in the same way the one line pattern match does. Look out for the examples in later sections for clarification on when this pattern could be useful.</p></div><h2>Alternative Pattern Match</h2><div class="content"><p>The alternative pattern allows you to check if multiple options match the input.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token number">0</span>
<span class="token keyword">in</span> <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">2</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>There isn't much more to it. The same rules apply as with any other pattern. So you can use the <code>^</code> operator if you are using variables to compare.</p></div><h2>Guard Conditions</h2><div class="content"><p>This isn't a pattern per se, but a way to make sure the pattern is only matched if the guard condition holds true.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">some_other_value <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token keyword">case</span> <span class="token number">0</span>
<span class="token keyword">in</span> <span class="token number">0</span> <span class="token keyword">if</span> some_other_value
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can use any expression in the condition that can evaluate to true or false. You can also use <code>unless</code> instead of <code>if</code> if it suits you.</p></div><h2>Array Pattern Match</h2><div class="content"><p>Matching against arrays can be done in a few different ways. At its most basic, you can match against the exact elements in the array.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">then</span> puts <span class="token symbol">:match</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token keyword">then</span> puts <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>That works using the <code>===</code> operator from the object pattern match so would work using case/when. That's no fun, so let's ramp it up a little bit.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Here we've matched against the type of the arrays elements. This is an example of Ruby matching against a pattern rather than the actual values in the array.</p><p>What happens if we have more elements in the array?</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [1, 2, 3] (NoMatchingPatternError)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>An error! Ruby appears to only match against arrays with the same number of elements. What if you want to match against only part of an array? Use the trusty splat <code>*</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can place the splat anywhere in an array to match against multiple entries.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Here we are checking only the first and last two elements are Integers. You can also mix and match between checking actual values and types.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token builtin">Integer</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>If you want to scoop up the values of the array matched against the splat, you can use the variable pattern.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">*</span>tail<span class="token punctuation">]</span>
  p tail
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [3, 4]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>If you don't care about some values in the array and are happy to match against any value for that index you can use <code>_</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Let's say you want to match against an array of two numbers, but only if they aren't the same number. You can use a guard clause.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token keyword">unless</span> a <span class="token operator">==</span> b
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can even match against nested arrays.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span>_<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>This is where the real power of pattern matching shines: traversing deeply nested structures for matches.</p><p>You can incorporate the variable pattern to bind matching values to variables to use later.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">]</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 4</span>
<span class="token comment"># =&gt; 5</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Let's say you have a nested array and you want to match against both the nested array and some individual parts of it. This is where the as pattern can be used.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> a<span class="token punctuation">]</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">]</span>
  puts a
  p arr
<span class="token keyword">end</span>

<span class="token comment"># =&gt; 5</span>
<span class="token comment"># =&gt; [4, 5]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Be careful with variable reassignment as we discussed earlier.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> arr
  <span class="token symbol">:match</span>
<span class="token keyword">end</span>

p arr

<span class="token comment"># =&gt; [1, 2, 4]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>One last point to note is that when matching an array the <code>[]</code> are optional on the outer array.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>

<span class="token keyword">case</span> arr
<span class="token keyword">in</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2>Hash Pattern Matching</h2><div class="content"><p>Pattern Matching with Hashes works in a similar way to arrays with a couple of important differences. The first is that pattern matching only works for symbol keys, not string keys. The reason for this is to do with how Ruby matches against a hash. This may change in future Ruby versions. The second important difference is that unlike with arrays, you can match against parts of a Hash without having to handle the fact there may be additional key-value pairs.</p><p>We can match against the actual values of a hash.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'aardvark'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'bat'</span></span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>We can match against a hash and assign values to variables.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> a<span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> b <span class="token punctuation">}</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; apple</span>
<span class="token comment"># =&gt; banana</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Because of Ruby syntactic sugar for hashes, we could rewrite the above as below. Note how we don't have to provide names for the variables. This isn't pattern matching behaviour but normal Ruby hash behaviour.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token punctuation">}</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; apple</span>
<span class="token comment"># =&gt; banana</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>As with arrays, with hashes you can omit the brackets <code>{}</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'apple'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'banana'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> a<span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span>
  puts a
  puts b
<span class="token keyword">end</span>

<span class="token comment"># =&gt; apple</span>
<span class="token comment"># =&gt; banana</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You can use the double splat <code>**</code> to scoop up multiple key-value pairs.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span><span class="token punctuation">,</span> <span class="token symbol">c</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'cat'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token operator">**</span>rest <span class="token punctuation">}</span>
  p rest
<span class="token keyword">end</span>

<span class="token comment"># =&gt; { :b =&gt; "ball", :c =&gt; "cat" }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Something to be mindful of with hashes is that because a hash will match with only a subset of keys matching, you need to guard against situations where you don't want that behaviour.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span> <span class="token punctuation">}</span>
  <span class="token string-literal"><span class="token string">'this will match'</span></span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
  <span class="token string-literal"><span class="token string">'this will never be reached'</span></span>
<span class="token keyword">end</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>If you want to ensure you only match exactly you can use <code>**nil</code>.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token operator">**</span><span class="token keyword">nil</span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:no_match</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
  puts <span class="token symbol">:match</span>
<span class="token keyword">end</span>

<span class="token comment"># =&gt; match</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>We can use the as pattern to assign the entire hash match to a variable.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span><span class="token punctuation">,</span> <span class="token symbol">b</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ball'</span></span> <span class="token punctuation">}</span>
<span class="token keyword">in</span> <span class="token punctuation">{</span> <span class="token symbol">a</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'ant'</span></span> <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> hash
  p hash
<span class="token keyword">end</span>

<span class="token comment">#=&gt; { :a =&gt; 'ant', :b =&gt; 'ball' }</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2>Ruby 3 Patterns</h2><div class="content"><p>With Ruby 3 came a couple of new patterns. You may get a warning about these features being experimental and subject to change so they aren't yet considered ready for any production code.</p></div><h2>Rightward Assignment</h2><div class="content"><p>Usually, you place variables on the left of an expression that binds a value to that variable. With rightward assignment you deconstruct an object and assign values to variables on the right of the expression. Instead of using <code>=</code> to assign you use a hash rocket <code>=&gt;</code>.</p><p>All of the previous patterns we've covered can be used in this syntax.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">login <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'hornby'</span></span><span class="token punctuation">,</span> <span class="token symbol">password</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'iliketrains'</span></span> <span class="token punctuation">}</span>

login <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token symbol">username</span><span class="token operator">:</span> username <span class="token punctuation">}</span>

puts <span class="token string-literal"><span class="token string">"Logged in with username </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">username</span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span>

<span class="token comment">#=&gt; "Logged in with username hornby"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>The case/in format is best used when there are multiple conditionals you could possibly match against and you need to check against all of them. The hash rocket syntax is best used when the data structure you are matching against is known, such as the login data example we used above.</p></div><h2>Find Pattern</h2><div class="content"><p>As we saw earlier, we can match against part of a hash using the array pattern match. So what do you do if you need to match against part of an array? The as pattern would capture all of the array and the variable pattern captures individual parts of it. To address this, Ruby added the find pattern.</p><p>It works by placing a <code>*</code> either side of the part you want to match. You can even use the variable pattern to give each <code>*</code> a variable name to reference later. Let's look at some examples.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span>pre<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">*</span>post<span class="token punctuation">]</span>
  p pre
  p post
<span class="token keyword">end</span>

<span class="token comment"># =&gt; []</span>
<span class="token comment"># =&gt; []</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Because everything was matched between the pattern our <code>pre</code> and <code>post</code> variables were assigned empty arrays. Let's see what happens when they aren't.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span>pre<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">*</span>post<span class="token punctuation">]</span>
  p pre
  p post
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [1]</span>
<span class="token comment"># =&gt; [4, 5]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Here's an interesting one. Let's say you have a mixed array of strings and integers and want to match on the first instance of two consecutive strings. While that would be a bit of a pain to implement without using pattern matching, with the find pattern it's easy. We can even throw in the as pattern to grab the values of the two consecutive strings.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby"><span class="token keyword">case</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"a"</span></span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"b"</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"c"</span></span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span>pre<span class="token punctuation">,</span> <span class="token builtin">String</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">,</span> <span class="token builtin">String</span> <span class="token operator">=&gt;</span> z<span class="token punctuation">,</span> <span class="token operator">*</span>post<span class="token punctuation">]</span>
  p pre
  p x
  p z
  p post
<span class="token keyword">end</span>

<span class="token comment"># =&gt; [1, 2, "a", 4]</span>
<span class="token comment"># =&gt; "b"</span>
<span class="token comment"># =&gt; "c"</span>
<span class="token comment"># =&gt; [7, 8, 9]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>As a last example, we'll consider a common use case which will hopefully show where the find pattern could be a better fit than a conventional Ruby solution. It's not uncommon in Ruby to find yourself with an array of hashes or JSON data, and you might need to locate a record from that data. You need to match that data on a few hash keys. The data might look something like this.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">data <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'James'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'english'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'general manager'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Jill'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'italian'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'leet coder'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Helen'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'dutch'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'biscuit quality control'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Bob'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'english'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'table tennis king'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Betty'</span></span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'spanish'</span></span><span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'pie maker'</span></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Let's say you get a name, age, and job title as parameters. If that person exists, you need to return their first language, otherwise <code>nil</code>. Before pattern matching, you may do something like this.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'Jill'</span></span>
age <span class="token operator">=</span> <span class="token number">32</span>
job_title <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'leet coder'</span></span>

match <span class="token operator">=</span> data<span class="token punctuation">.</span>find <span class="token keyword">do</span> <span class="token operator">|</span>person<span class="token operator">|</span>
  person<span class="token punctuation">[</span><span class="token symbol">:name</span><span class="token punctuation">]</span> <span class="token operator">==</span> name <span class="token operator">&amp;&amp;</span> person<span class="token punctuation">[</span><span class="token symbol">:age</span><span class="token punctuation">]</span> <span class="token operator">==</span> age <span class="token operator">&amp;&amp;</span> person<span class="token punctuation">[</span><span class="token symbol">:job_title</span><span class="token punctuation">]</span> <span class="token operator">==</span> job_title
<span class="token keyword">end</span>

match<span class="token operator">&amp;.</span>fetch<span class="token punctuation">(</span><span class="token symbol">:first_language</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>A couple of things to note here. Firstly, because <code>match</code> could be <code>nil</code> if it couldn't find a record, we had to use the <code>&amp;</code> safe search navigator to check that we could call fetch on match. Otherwise, it would have blown up with a no method error. Secondly, while this isn't actually that bad, imagine we had more than 3 fields to search. What if there were 10? Our code would start to get out of control.</p><p>Now let's see how we could have handled it using a pattern match.</p><pre class="line-numbers language-ruby" tabindex="0"><code class="language-ruby">name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'Jill'</span></span>
age <span class="token operator">=</span> <span class="token number">32</span>
job_title <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'leet coder'</span></span>

<span class="token keyword">case</span> data
<span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token symbol">name</span><span class="token operator">:</span> <span class="token operator">^</span>name<span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> <span class="token operator">^</span>age<span class="token punctuation">,</span> <span class="token symbol">first_language</span><span class="token operator">:</span> first_language<span class="token punctuation">,</span> <span class="token symbol">job_title</span><span class="token operator">:</span> <span class="token operator">^</span>job_title <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">]</span>
<span class="token keyword">else</span>
  first_language <span class="token operator">=</span> <span class="token keyword">nil</span>
<span class="token keyword">end</span>

puts first_language

<span class="token comment"># =&gt; italian</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>With pattern matching, we do need to consider the case if there is no match. Without the else clause, we'd get the no matching pattern error. But that is exactly what the else clause is for in the case statement. We get a couple of benefits from doing it this way. Firstly, we can bind the <code>first_language</code> value to a variable right there in the pattern. Secondly, and we acknowledge this is somewhat subjective, but we find it beneficial in the case statement to see exactly what kind of data structure we're trying to match against. This can be useful when getting to grips with code where the data may come from a third party API. And remember, this is still a very simplistic example. In the real world, data can be nested several levels deep which can lead to a horrible tangle of spaghetti code when trying to make sure you can locate a value several levels deep. What if you had to dive 6 levels, but grab a value or two along the way from a couple of the higher levels? No problem with pattern matching.</p></div><h2>Wrapping Up</h2><div class="content"><p>Pattern Matching provides a powerful way to get at the data you need in a way that makes sense. But as with any tool, you don't need to reach for it in every use case. For data structures that are shallow, just think about whether you need to bring in a pattern match when you could just grab the value using the hash and array methods already available. If you do find yourself deep in a nested structure with many checks for <code>nil</code> and a lot of edge case handling, it might be time to see if pattern matching brings something to the table.</p></div><h2>Assignment</h2><div class="content"><div class="lesson-content__panel">

    <ol>
      <li>Start with the <a href="https://docs.ruby-lang.org/en/3.0/syntax/pattern_matching_rdoc.html" target="_blank" rel="noopener noreferrer">Ruby docs</a> on pattern matching. They cover quite a lot of ground.</li>
      <li>One thing we didn't cover here is matching your own objects. We did mention implementing the <code>===</code> method, but there are a couple of other methods you can implement that will allow you to use array and hash pattern matching. Check out this <a href="https://rubyreferences.github.io/rubyref/language/pattern-matching.html" target="_blank" rel="noopener noreferrer">guide to pattern matching</a>, particularly this section on <a href="https://rubyreferences.github.io/rubyref/language/pattern-matching.html#matching-non-primitive-objects-deconstruct_keys-and-deconstruct" target="_blank" rel="noopener noreferrer">matching objects</a>.</li>
    </ol>
  </div></div><h2>Additional Resources</h2><div class="content"><p>This section contains helpful links to other content. It isn't required, so consider it supplemental.</p><ul>
    <li><a href="https://blog.appsignal.com/2021/07/28/introduction-to-pattern-matching-in-ruby.html" target="_blank" rel="noopener noreferrer">An Introduction to Pattern Matching in Ruby</a> from AppSignal should be another useful perspective on the material.</li>
    <li><a href="https://rubyreferences.github.io/rubyref/language/pattern-matching.html" target="_blank" rel="noopener noreferrer">Pattern matching</a> from Ruby References (Github) covers some more practical uses</li>
  </ul></div><h2>Knowledge Check</h2><div class="content"><p>This section contains questions for you to check your understanding of this lesson. If you're having trouble answering the questions below on your own, review the material above to find the answer.</p><ul>
    <li><a class="knowledge-check-link" href="https://docs.ruby-lang.org/en/3.0/syntax/pattern_matching_rdoc.html">What is pattern matching?</a></li>
    <li><a class="knowledge-check-link" href="https://docs.ruby-lang.org/en/3.0/syntax/pattern_matching_rdoc.html#label-Patterns">What is the difference between array patterns and hash patterns?</a></li>
    <li><a class="knowledge-check-link" href="#variable-pattern">What is the variable pattern match?</a></li>
    <li><a class="knowledge-check-link" href="#array-pattern-match">What are the different ways of pattern matching on an array?</a></li>
    <li><a class="knowledge-check-link" href="#find-pattern">Explain the find pattern.</a></li>
  </ul></div></div></div><div class="sticky bottom-0 left-0 right-0 flex justify-end px-4 pt-4 pb-5 bg-white border-t border-gray"><button class="inline-flex justify-center rounded-md border border-transparent text-base font-medium  shadow-sm hover:bg-indigo-700 focus:outline-none sm:text-sm inline-flex w-full justify-center rounded-md border border-transparent bg-gray-300 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:text-sm h-9 text-13px px-20px w-auto" type="button" aria-label="button" disabled="">Mark as complete</button></div></div><div class="flex-col w-4/12"><div class="pb-2 mb-2 border-b border-gray"><div class="pt-4 pb-2 pl-2 ml-2 text-lg font-medium">Additional Links</div></div><div class="pl-3 mt-2 overflow-y-scroll text-sm" style="height: 100vh;"><nav class="sticky flex"><div class="w-full px-2 "></div></nav></div></div></div></main></div><div></div></div></div><script>window.fwSettings={widget_id:89000000687},function(){if("function"!=typeof window.FreshworksWidget){var i=function(){i.q.push(arguments)};i.q=[],window.FreshworksWidget=i}}()</script><script type="text/javascript" src="https://ind-widget.freshworks.com/widgets/89000000687.js" async="" defer="defer"></script><div id="freshworks-container" data-html2canvas-ignore="true" style="width: 0px; height: 0px; bottom: 0px; right: 0px; z-index: 2147483647;"><div aria-live="polite"><iframe allowfullscreen="" id="launcher-frame" data-testid="launcher-frame" style="right: 22px; bottom: 22px; border: none; position: fixed; min-width: 104px; max-width: 156px; height: 56px; z-index: 2147483000; visibility: visible;"></iframe></div></div><iframe title="FreshworksWidget" id="freshworks-frame" data-html2canvas-ignore="true" style="display: none;"></iframe><div id="headlessui-portal-root"><div data-headlessui-portal=""><button type="button" data-headlessui-focus-guard="true" aria-hidden="true" style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px;"></button><div><div class="relative z-40 md:hidden" id="headlessui-dialog-:r6:" role="dialog" aria-modal="true" data-headlessui-state="open"><div class="fixed inset-0 bg-gray-600 bg-opacity-75"></div><div class="fixed inset-0 z-40 flex"><div class="relative flex flex-col flex-1 w-full max-w-xs pt-5 pb-4 bg-white" id="headlessui-dialog-panel-:r7:" data-headlessui-state="open"><div class="absolute top-0 right-0 pt-2 -mr-12"><button type="button" class="flex items-center justify-center w-10 h-10 ml-1 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white"><span class="sr-only">Close sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-6 h-6 text-white"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="flex items-center justify-between flex-shrink-0 px-4"><img class="w-auto h-8" src="/static/media/cogoport_logo.d263efa364f64be3527aa336fdb65893.svg" alt="Your Company"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 cursor-pointer"><path stroke-linecap="round" stroke-linejoin="round" d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"></path></svg></div><div class="flex-1 h-0 mt-5 overflow-y-auto"><h2>Course Content</h2><nav class="px-2 space-y-1"><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 bg-sky-100"><span class="
              mr-4 mt-1 text-primary"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              text-primary
            "><span>Pattern Matching<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(9, 103, 140);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div><div class="flex justify-between items-baseline pl-5 pr-2 py-2 rounded-md cursor-pointer hover:bg-sky-100 false"><span class="
              mr-4 mt-1"><input class="w-4 h-4" type="checkbox" readonly=""></span><div class="flex justify-between items-start flex-1 text-sm mb-1
              
            "><span>Blocks<br><span class="inline-flex items-center text-gray-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5" style="color: rgb(52, 64, 84);"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"></path></svg><span class="pl-1">5 min</span></span></span></div></div></nav></div></div><div class="flex-shrink-0 w-14" aria-hidden="true"></div></div></div></div><button type="button" data-headlessui-focus-guard="true" aria-hidden="true" style="position: fixed; top: 1px; left: 1px; width: 1px; height: 0px; padding: 0px; margin: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: nowrap; border-width: 0px;"></button></div></div></body></html>